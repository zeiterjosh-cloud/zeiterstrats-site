<script>
const CLIENT_ID = "62t19tqfi57iuhzc6oxjfzilzg16hm";
const CLIENT_SECRET = "62t19tqfi57iuhzc6oxjfzilzg16hm"; 
const CHANNEL_NAME = "zeiterstrats";

let appToken = null;

async function getAppToken(){
const res = await fetch("https://id.twitch.tv/oauth2/token",{
method:"POST",
headers:{ "Content-Type":"application/x-www-form-urlencoded" },
body:`client_id=${CLIENT_ID}&client_secret=${CLIENT_SECRET}&grant_type=client_credentials`
});
const data = await res.json();
appToken = data.access_token;
}

async function checkLive(){

if(!appToken) await getAppToken();

try{

const userRes = await fetch(
`https://api.twitch.tv/helix/users?login=${CHANNEL_NAME}`,{
headers:{
"Client-ID": CLIENT_ID,
"Authorization": "Bearer " + appToken
}
});

const userData = await userRes.json();
if(!userData.data || userData.data.length===0){
document.getElementById("liveStatus").innerText="User lookup failed.";
return;
}

const userId = userData.data[0].id;

const streamRes = await fetch(
`https://api.twitch.tv/helix/streams?user_id=${userId}`,{
headers:{
"Client-ID": CLIENT_ID,
"Authorization": "Bearer " + appToken
}
});

const streamData = await streamRes.json();

const statusEl=document.getElementById("liveStatus");
const viewerEl=document.getElementById("viewerCount");
const btn=document.getElementById("twitchBtn");

if(streamData.data.length>0){
const viewers=streamData.data[0].viewer_count;
statusEl.innerHTML="ðŸŸ¢ LIVE RIGHT NOW";
viewerEl.innerHTML=`ðŸ‘¥ ${viewers} watching`;
btn.innerText="ðŸ”¥ WATCH LIVE";
btn.classList.add("live");
btn.onclick=()=>window.open("https://twitch.tv/"+CHANNEL_NAME);
}else{
statusEl.innerHTML="ðŸ”´ Offline";
viewerEl.innerHTML="";
btn.innerText="Follow on Twitch";
btn.onclick=()=>window.open("https://twitch.tv/"+CHANNEL_NAME);
}

}catch(err){
document.getElementById("liveStatus").innerText="API Error.";
console.error(err);
}
}

checkLive();
setInterval(checkLive,60000);
</script>